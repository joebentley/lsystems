<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>lsystems.turtle documentation</title><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id="MathJax-script" async="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Lsystems</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Basic L-systems overview</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lsystems</span></div></div></li><li class="depth-2 branch"><a href="lsystems.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="lsystems.examples.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>examples</span></div></a></li><li class="depth-2 branch current"><a href="lsystems.turtle.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>turtle</span></div></a></li><li class="depth-2"><a href="lsystems.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="lsystems.turtle.html#var-draw-lines"><div class="inner"><span>draw-lines</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-execute-state-with-rules"><div class="inner"><span>execute-state-with-rules</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-fit-line-segments-to-screen"><div class="inner"><span>fit-line-segments-to-screen</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-forward"><div class="inner"><span>forward</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-get-pos-and-angle"><div class="inner"><span>get-pos-and-angle</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-make-canvas"><div class="inner"><span>make-canvas</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-new-line-segment"><div class="inner"><span>new-line-segment</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-new-pen-state"><div class="inner"><span>new-pen-state</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-pen-down"><div class="inner"><span>pen-down</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-pen-up"><div class="inner"><span>pen-up</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-pop-pos-and-angle"><div class="inner"><span>pop-pos-and-angle</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-push-pos-and-angle"><div class="inner"><span>push-pos-and-angle</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-render-to-canvas-by-executing-state-with-rules"><div class="inner"><span>render-to-canvas-by-executing-state-with-rules</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-rotate"><div class="inner"><span>rotate</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-save-canvas-to-file"><div class="inner"><span>save-canvas-to-file</span></div></a></li><li class="depth-1"><a href="lsystems.turtle.html#var-show-window"><div class="inner"><span>show-window</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">lsystems.turtle</h1><div class="doc"><div class="markdown"><p>Everything to do with drawing the L-system to the screen.</p>
<p>We use the excellent <a href="https://github.com/Clojure2D/clojure2d">Clojure2D</a> to do the rendering, and we implement a simple version of <a href="https://en.wikipedia.org/wiki/Turtle_graphics">turtle graphics</a>â€“where a pen is controlled by movement commands and lines are drawn out along its movement path.</p>
<p>The central object is the pen state, produced by <code>(new-pen-state ...)</code>, which stores the current pen position and orientation, whether or not the pen is down, a stack for pushing and popping the pen position and orientation, and a list for storing the generated line segments, which are added by the function <code>(forward [pen-state by-pixels])</code> if the pen is down.</p>
<p>The actual rendering is done by the <code>(draw-lines [canvas line-segments])</code> function.</p>
<p>Line segments are of the form of a map <code>{ :from { :x :y } :to { :x :y } }</code>.</p></div></div><div class="public anchor" id="var-draw-lines"><h3>draw-lines</h3><div class="usage"><code>(draw-lines canvas line-segments)</code></div><div class="doc"><pre class="plaintext">Draw the line segments given by `line-segments` onto the canvas.
</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L114">view source</a></div></div><div class="public anchor" id="var-execute-state-with-rules"><h3>execute-state-with-rules</h3><div class="usage"><code>(execute-state-with-rules state rules pen-state)</code></div><div class="doc"><pre class="plaintext">Take the L-system state, a rules map from L-system characters to functions that take and return
the current pen state, and the initial pen state, and executes each character of the L-system
state in turn, returning the pen state containing the finished line segments in (pen-state :lines).</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L102">view source</a></div></div><div class="public anchor" id="var-fit-line-segments-to-screen"><h3>fit-line-segments-to-screen</h3><div class="usage"><code>(fit-line-segments-to-screen width height line-segments &amp; {:keys [padding], :or {padding 0}})</code></div><div class="doc"><pre class="plaintext">Resize and move all line segments so that they fit on screen. Can optionally pass :padding keyword
to pad figure on every side of screen.

TODO: can I use transducers to speed this up? I need to profile it first.</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L148">view source</a></div></div><div class="public anchor" id="var-forward"><h3>forward</h3><div class="usage"><code>(forward pen-state by-pixels)</code></div><div class="doc"><pre class="plaintext">Move the pen forward by `by-pixels` in the direction specified by (pen-state :facing), adding a line segment
to (pen-state :lines) if the pen is down. Returns the updated pen-state.
If (pen-state :continue-line-segment?) is true the last line segment will be extended rather than creating a new one.
Sets (pen-state :continue-line-segment?) to true.</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L50">view source</a></div></div><div class="public anchor" id="var-get-pos-and-angle"><h3>get-pos-and-angle</h3><div class="usage"><code>(get-pos-and-angle pen-state)</code></div><div class="doc"><pre class="plaintext">Get the position and facing angle from the pen state.
</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L37">view source</a></div></div><div class="public anchor" id="var-make-canvas"><h3>make-canvas</h3><div class="usage"><code>(make-canvas width height)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L120">view source</a></div></div><div class="public anchor" id="var-new-line-segment"><h3>new-line-segment</h3><div class="usage"><code>(new-line-segment from-x from-y to-x to-y)</code></div><div class="doc"><pre class="plaintext">Create a new line segment.
</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L45">view source</a></div></div><div class="public anchor" id="var-new-pen-state"><h3>new-pen-state</h3><div class="usage"><code>(new-pen-state x y &amp; {:keys [facing pen-is-down?], :or {facing 0, pen-is-down? true}})</code></div><div class="doc"><pre class="plaintext">Creates a new pen state object. Keeps track of the pens current position, its orientation, whether or not it is
down, a stack for pushing and popping the current position and orientation, and a list for storing calculated line
segments to be rendered later.</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L23">view source</a></div></div><div class="public anchor" id="var-pen-down"><h3>pen-down</h3><div class="usage"><code>(pen-down pen-state)</code></div><div class="doc"><pre class="plaintext">Forward will draw lines, as well as moving the cursor. TODO: test
</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L81">view source</a></div></div><div class="public anchor" id="var-pen-up"><h3>pen-up</h3><div class="usage"><code>(pen-up pen-state)</code></div><div class="doc"><pre class="plaintext">Forward will no longer draw lines, it will just move the cursor. TODO: test
</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L76">view source</a></div></div><div class="public anchor" id="var-pop-pos-and-angle"><h3>pop-pos-and-angle</h3><div class="usage"><code>(pop-pos-and-angle pen-state)</code></div><div class="doc"><pre class="plaintext">Pop the pens position and facing direction, off the stack into the pen state's current values.
Sets (pen-state :continue-line-segment?) to false.</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L94">view source</a></div></div><div class="public anchor" id="var-push-pos-and-angle"><h3>push-pos-and-angle</h3><div class="usage"><code>(push-pos-and-angle pen-state)</code></div><div class="doc"><pre class="plaintext">Push the pens position and facing direction onto the stack.
Sets (pen-state :continue-line-segment?) to false.</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L86">view source</a></div></div><div class="public anchor" id="var-render-to-canvas-by-executing-state-with-rules"><h3>render-to-canvas-by-executing-state-with-rules</h3><div class="usage"><code>(render-to-canvas-by-executing-state-with-rules state rules f &amp; {:keys [width height initial-x initial-y facing canvas-function auto-resize? auto-resize-padding], :or {width 600, height 600, initial-x 300, initial-y 300, facing 0, canvas-function identity, auto-resize? true, auto-resize-padding 100}})</code></div><div class="doc"><div class="markdown"><p>Setup a window and canvas and pen-state with given options and execute a given L-system state, and function <code>f</code> that takes the rendered canvas as an argument.</p>
<p>The :canvas-function key should be a function that takes a canvas object and can be used to do extra drawing or changing the canvas settings <em>before</em> rendering the lines.</p>
<p>Use the :auto-resize? key along with :auto-resize-padding to automatically resize the drawn figure to fit on the screen.</p>
<p>Description of all keys:</p>
<ul>
  <li><code>:width</code> <code>:height</code> integer, width and height in pixels of the canvas, default 600 600</li>
  <li><code>:initial-x</code> <code>:initial-y</code> integer, initial position of the pen. Does nothing if <code>auto-resize?</code> is true. default 300 300</li>
  <li><code>:facing</code> float, the initial facing direction of the pen. default 0</li>
  <li><code>:canvas-function</code> described above. default <code>identity</code> (do nothing)</li>
  <li><code>:auto-resize?</code> boolean, whether or not to automatically fit the drawing to the canvas. default <code>true</code></li>
  <li><code>:auto-resize-padding</code> integer, number of pixels padding when fitting the drawing to the canvas. default 100</li>
</ul></div></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L178">view source</a></div></div><div class="public anchor" id="var-rotate"><h3>rotate</h3><div class="usage"><code>(rotate pen-state by-angle)</code></div><div class="doc"><pre class="plaintext">Rotate the pen's facing direction and return the updated state.
Sets (pen-state :continue-line-segment?) to false.</pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L70">view source</a></div></div><div class="public anchor" id="var-save-canvas-to-file"><h3>save-canvas-to-file</h3><div class="usage"><code>(save-canvas-to-file canvas filename)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L174">view source</a></div></div><div class="public anchor" id="var-show-window"><h3>show-window</h3><div class="usage"><code>(show-window canvas window-name)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/joebentley/lsystems/blob/master/src/lsystems/turtle.clj#L132">view source</a></div></div></div></body></html>